# Cursor AI Rules for Epguides API

## Code Style
- Follow PEP 8 with line length of 120 characters
- Use type hints for all function parameters and return types
- Use async/await for all I/O operations
- Prefer composition over inheritance
- Use dependency injection via FastAPI Depends()

## Python Standards
- Maximum line length: 120 characters
- Use double quotes for strings (black default)
- Use f-strings for string formatting
- Use pathlib for file paths
- Use dataclasses or Pydantic models for data structures

## FastAPI Best Practices
- Use Pydantic models for request/response validation
- Use async endpoints for all routes
- Use dependency injection for services
- Return proper HTTP status codes
- Use descriptive endpoint summaries and descriptions

## Error Handling
- Use specific exception types
- Log errors with appropriate levels
- Return meaningful error messages to clients
- Use HTTPException for API errors

## Testing
- Write tests for all service methods
- Use pytest and pytest-asyncio
- Mock external dependencies
- Test error cases

## Performance
- Use async/await for all I/O
- Cache expensive operations with Redis
- Use connection pooling for databases/Redis
- Avoid blocking operations in async code

## Documentation
When making changes, ALWAYS update ALL relevant documentation:

### Docstrings
- Add docstrings to all public functions and classes
- Include Args, Returns, and Raises sections
- Update docstrings when function behavior changes

### README.md
- Update when adding/removing features or endpoints
- Keep examples current and working
- Update caching strategy if TTLs change

### ReadTheDocs (docs/ folder)
- `docs/index.md` - Update features list
- `docs/rest-api.md` - Update when endpoints change
- `docs/mcp-server.md` - Update when MCP tools change
- `docs/configuration.md` - Update when env vars change
- `docs/development.md` - Update when dev workflow changes
- `docs/getting-started.md` - Keep quick start current

### Swagger/OpenAPI
- Use descriptive `summary` and `description` in endpoints
- Add `examples` to Query parameters
- Keep response models accurate

### Code Comments
- Use type hints for better IDE support
- Add inline comments for complex logic
- Keep constants documented with docstrings

## Versioning
- Version is auto-incremented via pre-commit hook (VERSION file)
- No manual version management needed
- MCP protocol version is in `app/core/constants.py`

## Project Structure
- `app/api/endpoints/` - REST API endpoints
- `app/core/` - Config, cache, middleware, constants
- `app/mcp/` - MCP server implementation
- `app/models/` - Pydantic schemas
- `app/services/` - Business logic
- `app/tests/` - Test suite
- `docs/` - ReadTheDocs documentation

## Caching
- Finished shows: 1 year (CACHE_TTL_FINISHED)
- Ongoing shows: 7 days (settings.CACHE_TTL_SECONDS)
- Shows master list: 30 days (CACHE_TTL_SHOWS_METADATA_SECONDS)
- Update these in `app/core/constants.py` and `app/core/cache.py`


